# MTS Design Weekend - Карты предсказаний

Интерактивное мини-приложение для Telegram, которое позволяет получать уникальные метафорические предсказания на основе дизайнерских карт.

## Функциональность

- Интеграция с Telegram как мини-приложение (Telegram WebApp)
- Загрузка фотографий карт с предпросмотром
- Распознавание QR-кодов на картах для точной идентификации
- Генерация уникальных метафорических предсказаний
- Возможность поделиться предсказанием
- Совместимость с мобильными устройствами
- Опциональная интеграция с OpenAI API для генерации уникальных предсказаний

## Технологии

- HTML5, CSS3, JavaScript (ванильный, без фреймворков)
- Telegram Bot API и WebApp API
- jsQR для распознавания QR-кодов
- Web Share API для функции "Поделиться"


В последнем обновлении приложения MTS Design Weekend были исправлены следующие проблемы:

1. **Улучшена обработка ошибок WebGL**:
   - Добавлена проверка поддержки WebGL в браузере пользователя
   - Добавлено информативное сообщение, если WebGL не поддерживается
   - Приложение теперь корректно работает даже при отсутствии поддержки WebGL (без 3D эффектов)

2. **Улучшена валидация QR-кодов**:
   - Исправлена ошибка, когда при нераспознанном QR-коде использовалась случайная карта
   - Добавлено сообщение пользователю с просьбой сделать более четкое фото
   - Проверяется соответствие QR-кода существующим картам в системе

3. **Добавлена фильтрация нецензурной лексики**:
   - Реализована проверка вопросов на наличие нецензурных слов
   - Добавлена защита от обхода фильтров с помощью символов-заменителей
   - Проверка минимальной длины вопроса для более осмысленных запросов

4. **Улучшена обработка файлов**:
   - Добавлена проверка типа загружаемых файлов (только изображения)
   - Добавлено ограничение на размер файла (не более 10 МБ)
   - Информативные сообщения при ошибках загрузки файлов

5. **Улучшена обработка ошибок**:
   - Добавлены более детальные сообщения об ошибках
   - Добавлена индикация предупреждений с желтым цветом
   - Исправлены ошибки в CSS, связанные с отображением элементов

## Обновления интерфейса (07.05.2025)

В интерфейс приложения "Карты предсказаний" были внесены следующие улучшения:

### Экран вопроса
- Удален старый заголовок "Выберите или создайте вопрос"
- Добавлен новый заголовок "Выберите вопрос"
- Изменено расположение элементов: превью фото теперь между заголовком и блоком вопросов
- Изменен текст поля ввода на "Ваш вопрос"
- Изменен порядок кнопок навигации: сначала "Получить предсказание", затем "Назад"
- Добавлена логика активации кнопки "Получить предсказание" только после выбора/ввода вопроса
- Улучшена визуальная обратная связь при выборе вопроса

### Экран результатов
- Исправлены проблемы с отображением (скрытием) экрана результатов
- Добавлены принудительные стили для гарантированного отображения контента
- Отключены анимации, которые могли вызывать проблемы
- Улучшены стили для текста предсказания и изображения карты
- Исправлены размеры и стилизация кнопок действий

### Мобильная версия
- Исправлено позиционирование кнопок на первом экране (больше не прибиваются к низу на узких экранах)
- Улучшена адаптивность элементов на всех экранах
- Добавлены специальные стили для очень узких экранов (до 360px)
- Увеличены сенсорные области для лучшего взаимодействия на мобильных устройствах

### Исправления JavaScript
- Удалены невалидные селекторы, вызывающие ошибки в консоли
- Добавлена более эффективная функция для удаления текстовых узлов со строкой "download.png"
- Улучшена логика переключения между экранами
- Добавлены проверки на наличие элементов перед взаимодействием с ними

### Дополнительные улучшения
- Добавлены дополнительные проверки видимости элементов
- Улучшены стили кнопок с фиксированной высотой 
- Оптимизированы стили для лучшей совместимости с разными браузерами
- Добавлены дополнительные медиа-запросы для различных размеров экранов

## Работа с репозиторием

### Ветки
- `main` - основная ветка для разработки
- `master` - историческая ветка 
- `gh-pages` - автоматически обновляемая ветка для GitHub Pages

### Деплой
Для деплоя проекта используется GitHub Actions. Настроен автоматический деплой при коммите в ветки `main`, `master` и `gh-pages`.

```bash
# Для ручного деплоя можно использовать:
.\deploy.ps1  # Для Windows
./go.sh       # Для MacOS/Linux
```